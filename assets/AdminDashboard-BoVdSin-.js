import{r as m,j as e,R as V,Q as C,a5 as D,aw as B,ak as W,q as U,T as z,G,ax as _,ay as A,az as F,a8 as H,aA as K,c as Y,ac as q}from"./index-COUSDRnw.js";import{C as Q}from"./ConfirmModal-CyNdXQx2.js";const J=l=>{if(l==="Unknown")return"ðŸ³ï¸";const i=l.toUpperCase().split("").map(n=>127397+n.charCodeAt(0));return String.fromCodePoint(...i)},X=l=>new Date(l).toLocaleString("id-ID",{month:"short"}),j=({title:l,icon:i,children:n,defaultOpen:c=!1,className:a=""})=>{const[o,d]=m.useState(c);return e.jsxs("div",{className:`bg-white rounded-[2rem] shadow-sm border border-slate-100 overflow-hidden transition-all duration-300 ${a}`,children:[e.jsxs("div",{className:"p-5 flex items-center justify-between cursor-pointer hover:bg-slate-50/50 transition-colors",onClick:()=>d(!o),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[i,e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:l})]}),e.jsx("div",{className:`p-2 rounded-full text-slate-400 transition-transform duration-300 ${o?"rotate-180 bg-slate-50":""}`,children:e.jsx(Y,{className:"w-4 h-4"})})]}),e.jsx("div",{className:`transition-[max-height,opacity] duration-500 ease-in-out overflow-hidden ${o?"max-h-[1000px] opacity-100":"max-h-0 opacity-0"}`,children:e.jsx("div",{className:"p-5 pt-0 border-t border-slate-50",children:n})})]})},Z=({data:l,labelType:i})=>{if(!l||l.length===0)return e.jsx("div",{className:"h-40 flex items-center justify-center text-slate-300",children:"No Data"});const n=200,c=600,a=30,d=Math.max(...l.map(x=>x.value),5)*1.2,v=l.map((x,h)=>{const g=a+h/(l.length-1||1)*(c-2*a),f=n-a-x.value/d*(n-2*a);return`${g},${f}`}).join(" ");return e.jsxs("div",{className:"w-full overflow-visible",children:[e.jsxs("svg",{viewBox:`0 0 ${c} ${n}`,className:"w-full h-auto overflow-visible",children:[e.jsx("line",{x1:a,y1:a,x2:c-a,y2:a,stroke:"#f1f5f9",strokeWidth:"1",strokeDasharray:"4 4"}),e.jsx("line",{x1:a,y1:n/2,x2:c-a,y2:n/2,stroke:"#f1f5f9",strokeWidth:"1",strokeDasharray:"4 4"}),e.jsx("line",{x1:a,y1:n-a,x2:c-a,y2:n-a,stroke:"#e2e8f0",strokeWidth:"1"}),l.length>1&&e.jsx("polyline",{fill:"none",stroke:"#3b82f6",strokeWidth:"3",points:v,strokeLinecap:"round",strokeLinejoin:"round"}),l.map((x,h)=>{const g=a+h/(l.length-1||1)*(c-2*a),f=n-a-x.value/d*(n-2*a);return e.jsxs("g",{className:"group",children:[e.jsx("circle",{cx:g,cy:f,r:"4",fill:"white",stroke:"#3b82f6",strokeWidth:"2.5",className:"transition-all duration-300 group-hover:r-6"}),e.jsx("text",{x:g,y:f-12,textAnchor:"middle",fontSize:"12",fontWeight:"bold",fill:"#1e293b",className:"opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:x.value})]},h)})]}),e.jsx("div",{className:"flex justify-between px-2 mt-2 text-[10px] text-slate-400 font-medium",children:l.map((x,h)=>l.length>12&&h%2!==0?null:e.jsx("span",{children:x.label},h))})]})},N=({title:l,items:i,color:n="blue"})=>{const c=i&&i.length>0?Math.max(...i.map(o=>o.count),1):1,a={blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",pink:"bg-pink-500",amber:"bg-amber-500"};return e.jsxs("div",{className:"bg-slate-50/50 p-4 rounded-xl border border-slate-100 h-full flex flex-col",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a[n]}`})," ",l]}),!i||i.length===0?e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center py-4 rounded-lg",children:e.jsx("span",{className:"text-[10px] font-medium text-slate-400 italic",children:"Belum ada data"})}):e.jsx("div",{className:"space-y-3",children:i.map(o=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-[10px] font-bold text-slate-600 mb-1",children:[e.jsx("span",{className:"truncate pr-2 max-w-[120px]",children:o.label}),e.jsx("span",{children:o.count})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-1 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${a[n]||"bg-slate-800"}`,style:{width:`${o.count/c*100}%`}})})]},o.id))})]})},te=()=>{const[l,i]=m.useState(!0),[n,c]=m.useState(!1),[a,o]=m.useState(!1),[d,v]=m.useState("week"),[x,h]=m.useState(!1),[g,f]=m.useState(!1),[t,k]=m.useState(null),[b,M]=m.useState([]),[y,P]=m.useState(!1),S=async()=>{i(!0),await _("Admin Dashboard Accessed","User opened dashboard view");const[s,r,p]=await Promise.all([A(),F(),H("home_promo_enabled")]);k(s),M(r),h(p!=="false"),i(!1)};m.useEffect(()=>{S()},[]);const $=()=>{o(!0)},I=async()=>{c(!0),o(!1);try{await K();const s=await A();s&&k(r=>r?{...r,logs:s.logs}:s)}catch(s){console.error("Gagal menghapus log:",s),alert("Gagal menghapus log.")}finally{c(!1)}},T=async()=>{f(!0);const s=!x;h(s);try{await q("home_promo_enabled",s.toString())}catch(r){console.error(r),h(!s)}finally{f(!1)}},L=m.useMemo(()=>{if(!(t!=null&&t.allStats))return[];const s=t.allStats;if(d==="week")return s.slice(-7).map(r=>({label:r.date.slice(5),value:r.visitors||0}));if(d==="month")return s.slice(-30).map(r=>({label:r.date.slice(8),value:r.visitors||0}));if(d==="year"){const r={};for(let p=11;p>=0;p--){const u=new Date;u.setMonth(u.getMonth()-p);const R=u.toISOString().slice(0,7);r[R]=0}return s.forEach(p=>{const u=p.date.slice(0,7);r.hasOwnProperty(u)&&(r[u]+=p.visitors||0)}),Object.entries(r).map(([p,u])=>({label:X(p+"-01"),value:u}))}return[]},[t,d]),O=s=>new Date(s).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});if(l)return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 border-4 border-slate-200 border-t-slate-900 rounded-full animate-spin"})});if(!t)return e.jsx("div",{className:"p-10 text-center",children:"Failed to load data."});const w=t.allStats.length>1?Math.round((t.allStats[t.allStats.length-1].visitors-t.allStats[t.allStats.length-2].visitors)/(t.allStats[t.allStats.length-2].visitors||1)*100):0,E=y?b:b.slice(0,3);return e.jsxs("div",{className:"min-h-screen bg-slate-50 p-4 md:p-8 animate-fade-in",children:[e.jsx(Q,{isOpen:a,title:"Bersihkan Log Sistem?",description:"Tindakan ini akan menghapus semua riwayat aktivitas sistem secara permanen. Anda tidak dapat membatalkan ini.",confirmText:"Ya, Bersihkan",onConfirm:I,onCancel:()=>o(!1)}),e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-slate-900 tracking-tight",children:"Dashboard Overview"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Real-time insight & system health."})]}),e.jsxs("button",{onClick:S,className:"bg-white border border-slate-200 text-slate-600 px-4 py-2 rounded-xl text-xs font-bold flex items-center gap-2 hover:bg-slate-50 hover:text-slate-900 transition-colors shadow-sm",children:[e.jsx(V,{className:"w-3.5 h-3.5"})," Refresh Data"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-50 flex items-center justify-center shrink-0",children:e.jsx("img",{src:"https://cdn-icons-png.flaticon.com/128/8860/8860683.png",className:"w-6 h-6 object-contain opacity-80",alt:"Visitor"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 leading-none",children:t.totalVisitors7Days}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Visitors (7d)"})]}),w!==0&&e.jsxs("span",{className:`ml-auto text-[10px] font-bold px-1.5 py-0.5 rounded ${w>0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[w>0?"+":"",w,"%"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-indigo-50 flex items-center justify-center shrink-0",children:e.jsx("img",{src:"https://cdn-icons-png.flaticon.com/128/8860/8860683.png",className:"w-6 h-6 object-contain opacity-80",alt:"All Time"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 leading-none",children:t.totalVisitorsAllTime}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"All Time"})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center shrink-0",children:e.jsx(C,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 leading-none",children:b.length}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Messages"})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-50 text-red-600 flex items-center justify-center shrink-0",children:e.jsx(D,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 leading-none",children:t.totalErrors}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Errors"})]})]})]}),e.jsx(j,{title:"Marketing & Configuration",icon:e.jsx(B,{className:"w-5 h-5 text-purple-600"}),defaultOpen:!0,children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-slate-800",children:"Home Popup Promo"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:'Iklan "Project Unggulan" muncul 3 detik setelah masuk Home.'})]}),e.jsx("button",{onClick:T,disabled:g,className:`
                                    relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2
                                    ${x?"bg-purple-600":"bg-slate-200"}
                                    ${g?"opacity-50 cursor-wait":""}
                                `,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition duration-200 ease-in-out ${x?"translate-x-6":"translate-x-1"}`})})]})})}),e.jsx(j,{title:"Popular Content & Insights",icon:e.jsx(W,{className:"w-5 h-5 text-amber-500"}),defaultOpen:!1,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:[e.jsx(N,{title:"Top Menus",items:t.topMenus,color:"blue"}),e.jsx(N,{title:"Top Projects",items:t.topProjects,color:"purple"}),e.jsx(N,{title:"Top Blogs",items:t.topBlogs,color:"green"}),e.jsx(N,{title:"Top Photos",items:t.topPhotos,color:"pink"}),e.jsx(N,{title:"Top Music",items:t.topMusic,color:"amber"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(j,{title:`Inbox Rahasia (${b.length})`,icon:e.jsx(C,{className:"w-5 h-5 text-slate-900"}),defaultOpen:!1,children:[e.jsx("div",{className:"max-h-[400px] overflow-y-auto custom-scrollbar pr-2",children:b.length===0?e.jsx("div",{className:"p-8 text-center text-slate-400 text-xs italic",children:"Belum ada pesan."}):e.jsx("div",{className:"space-y-3 pt-2",children:E.map(s=>e.jsxs("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-[10px] font-bold bg-slate-200 text-slate-600 px-2 py-0.5 rounded",children:"Anonim"}),e.jsx("span",{className:"text-[10px] text-slate-400 font-mono",children:O(s.timestamp)})]}),e.jsx("p",{className:"text-slate-700 text-xs leading-relaxed whitespace-pre-wrap",children:s.content})]},s.id))})}),b.length>3&&e.jsx("div",{className:"pt-3 flex justify-center",children:e.jsx("button",{onClick:()=>P(!y),className:"text-[10px] font-bold text-slate-500 hover:text-slate-800 flex items-center gap-1",children:y?"Sembunyikan":"Lihat Semua"})})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(j,{title:"Traffic Trend",icon:e.jsx(U,{className:"w-5 h-5 text-blue-600"}),defaultOpen:!1,children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>v("week"),className:`px-3 py-1 text-[10px] font-bold rounded-md transition-all ${d==="week"?"bg-white text-slate-900 shadow-sm":"text-slate-500"}`,children:"Week"}),e.jsx("button",{onClick:()=>v("month"),className:`px-3 py-1 text-[10px] font-bold rounded-md transition-all ${d==="month"?"bg-white text-slate-900 shadow-sm":"text-slate-500"}`,children:"Month"}),e.jsx("button",{onClick:()=>v("year"),className:`px-3 py-1 text-[10px] font-bold rounded-md transition-all ${d==="year"?"bg-white text-slate-900 shadow-sm":"text-slate-500"}`,children:"Year"})]})}),e.jsx(Z,{data:L,labelType:d==="year"?"month":"day"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(j,{title:"System Logs",icon:e.jsx(D,{className:"w-5 h-5 text-slate-600"}),defaultOpen:!1,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-1",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Recent Activity"}),e.jsx("button",{onClick:$,disabled:n,className:"text-[10px] font-bold text-red-500 hover:text-red-700 hover:bg-red-50 px-2 py-1 rounded transition-colors flex items-center gap-1",children:n?"Cleaning...":e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-3 h-3"})," Hapus Semua Log"]})})]}),e.jsx("div",{className:"space-y-1 max-h-60 overflow-y-auto custom-scrollbar",children:t.logs.length===0?e.jsx("p",{className:"text-slate-400 text-xs italic text-center py-4",children:"No logs recorded."}):t.logs.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-slate-50 rounded-lg transition-colors border-b border-slate-50 last:border-0",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${s.type==="error"?"bg-red-500":s.type==="info"?"bg-blue-500":"bg-slate-400"}`}),e.jsx("span",{className:"text-[10px] font-mono text-slate-400 w-28 shrink-0",children:new Date(s.timestamp).toLocaleString("id-ID",{hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"})}),e.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700 truncate",children:s.message}),s.details&&e.jsx("span",{className:"text-[10px] text-slate-400 truncate border-l border-slate-200 pl-2 hidden sm:inline",children:s.details})]})]},s.id))})]}),e.jsx(j,{title:"Demographics",icon:e.jsx(G,{className:"w-5 h-5 text-indigo-500"}),defaultOpen:!1,children:e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto custom-scrollbar pt-2",children:t.geoStats.length===0?e.jsx("p",{className:"text-slate-400 text-xs italic",children:"No data yet."}):t.geoStats.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-lg w-6 text-center",children:J(s.country)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-[10px] font-bold text-slate-700 mb-1",children:[e.jsx("span",{children:s.country}),e.jsx("span",{children:s.count})]}),e.jsx("div",{className:"w-full bg-slate-100 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"bg-indigo-500 h-full rounded-full",style:{width:`${s.count/t.totalVisitorsAllTime*100}%`}})})]})]},r))})})]}),e.jsxs("div",{className:"bg-slate-900 p-6 rounded-[2rem] text-white shadow-xl relative overflow-hidden flex items-center justify-between",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h3",{className:"text-sm font-bold mb-1 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"})," System Operational"]}),e.jsx("p",{className:"text-[10px] text-slate-400",children:"Database Connected â€¢ API OK"})]}),e.jsx("div",{className:"relative z-10 text-right",children:e.jsx("p",{className:"text-[10px] text-slate-500",children:"v2.4.3 (Stable)"})}),e.jsx("div",{className:"absolute -bottom-10 -right-10 w-32 h-32 bg-blue-600/20 rounded-full blur-3xl pointer-events-none"})]})]})]})};export{te as default};
