import{r as i,j as e,E as U,U as E,q as Q,M as V,S as X,t as Z,v as ee,T as te,w as se,x as ae,s as o,y as le,z as ie,D as ne,l as re}from"./index-Cw6E8Nps.js";import{C as oe}from"./ConfirmModal-BCdQmYRN.js";const me=({isAdmin:m})=>{const[d,p]=i.useState([]),[s,u]=i.useState(null),[r,c]=i.useState(!1),[f,I]=i.useState(!0),[g,S]=i.useState(!1),[w,M]=i.useState(""),[v,L]=i.useState(""),[j,z]=i.useState(""),[y,P]=i.useState(""),[T,A]=i.useState(!1),_=i.useRef(null),$=i.useRef(null),[G,N]=i.useState(!1),[h,R]=i.useState(null),H=i.useRef(null),k=async()=>{I(!0);try{const t=await se();p(t),t.length>0&&(u(a=>a&&t.find(n=>n.id===a.id)||t[0]),c(!1))}catch(t){console.error(t)}finally{I(!1)}};i.useEffect(()=>{k()},[]),i.useEffect(()=>{let t;return!f&&d.length>0&&(t=setTimeout(()=>{c(!0)},5e3)),()=>{t&&clearTimeout(t)}},[f,d.length]);const O=t=>{try{if(t.includes("/track/")){const a=t.split("/track/");if(a.length>1)return a[1].split("?")[0]}if(t.includes("spotify:track:")){const a=t.split(":");if(a.length>2)return a[2]}if(t.length>15&&!t.includes("/"))return t}catch{return null}return null},q=t=>{var l;const a=(l=t.target.files)==null?void 0:l[0];if(a){const n=new FileReader;n.onloadend=()=>{P(n.result)},n.readAsDataURL(a)}},B=async()=>{if(!w||!v||!j){o("Harap isi URL, Judul, dan Artis.");return}const t=O(w);if(!t){o("Link Spotify tidak valid.");return}A(!0);try{await ie({spotifyId:t,title:v,artist:j,image:y,addedAt:Date.now()}),await k(),S(!1),M(""),L(""),z(""),P(""),o("Lagu berhasil ditambahkan!")}catch{o("Gagal menambahkan lagu.")}finally{A(!1)}},F=t=>{var l;const a=(l=t.target.files)==null?void 0:l[0];if(a&&(s!=null&&s.id)){const n=new FileReader;n.onloadend=async()=>{const b=n.result;try{await le(s.id,{image:b}),u(x=>x?{...x,image:b}:null),p(x=>x.map(C=>C.id===s.id?{...C,image:b}:C)),o("Cover lagu diperbarui!")}catch{o("Gagal update cover.")}},n.readAsDataURL(a)}},J=(t,a)=>{a.stopPropagation(),R(t),N(!0)},W=async()=>{if(h)try{if(await ae(h),p(t=>t.filter(a=>a.id!==h)),(s==null?void 0:s.id)===h){const t=d.filter(a=>a.id!==h);t.length>0?(u(t[0]),c(!1)):(u(null),c(!1))}o("Lagu dihapus.")}catch{o("Gagal menghapus.")}finally{N(!1),R(null)}},Y=t=>{(s==null?void 0:s.id)===t.id?c(!r):(u(t),c(!0),re("music",t.id||"unknown",`${t.title} - ${t.artist}`))},D=async(t,a)=>{if(a==="up"&&t===0||a==="down"&&t===d.length-1)return;const l=[...d],n=a==="up"?t-1:t+1;[l[t],l[n]]=[l[n],l[t]],p(l);try{await ne(l)}catch{o("Gagal menyimpan urutan."),k()}},K=`bg-gradient-to-tr ${r?"from-blue-300 to-purple-300":"from-slate-200 to-gray-200"}`;return e.jsxs("div",{className:"min-h-screen bg-white relative overflow-hidden flex flex-col h-full",children:[e.jsx("style",{children:".no-scrollbar::-webkit-scrollbar { display: none; } .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }"}),e.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-blue-50/50 rounded-full blur-3xl opacity-60 pointer-events-none translate-x-1/3 -translate-y-1/3"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-purple-50/50 rounded-full blur-3xl opacity-60 pointer-events-none -translate-x-1/3 translate-y-1/3"}),e.jsx(oe,{isOpen:G,title:"Hapus Lagu?",description:"Lagu ini akan dihapus dari playlist publik. Yakin?",confirmText:"Ya, Hapus",onConfirm:W,onCancel:()=>N(!1)}),e.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar relative z-10 pb-24",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-6 py-8 md:py-12",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-10",children:[e.jsx(U,{id:"music_title",defaultText:"Soundtrack of Life",isAdmin:m,tag:"h1",className:"text-3xl md:text-5xl font-black text-slate-900 tracking-tighter mb-2 md:mb-4"}),e.jsx(U,{id:"music_desc",defaultText:"Kumpulan frekuensi pengiring coding & kontemplasi malam.",isAdmin:m,tag:"p",className:"text-sm md:text-base text-slate-500 font-medium"})]}),s&&e.jsxs("div",{className:"relative rounded-[2rem] md:rounded-[2.5rem] p-6 md:p-8 shadow-2xl shadow-slate-200/50 mb-10 md:mb-12 overflow-hidden transition-all hover:shadow-slate-300/50 group/player border border-slate-100",style:{backgroundColor:s.image?"transparent":"rgba(255, 255, 255, 0.8)",backgroundImage:s.image?`url(${s.image})`:void 0,backgroundSize:"cover",backgroundPosition:"center"},children:[s.image&&e.jsx("div",{className:"absolute inset-0 bg-white/40 backdrop-blur-md z-0 transition-opacity duration-500"}),!s.image&&e.jsx("div",{className:"absolute inset-0 z-0 opacity-20 blur-3xl scale-125 pointer-events-none transition-colors duration-1000",children:e.jsx("div",{className:`w-full h-full ${K}`})}),m&&e.jsxs("div",{className:"absolute top-4 right-4 z-30 flex gap-2 opacity-0 group-hover/player:opacity-100 transition-opacity",children:[e.jsx("input",{type:"file",ref:$,onChange:F,className:"hidden",accept:"image/*"}),e.jsx("button",{onClick:()=>{var t;return(t=$.current)==null?void 0:t.click()},className:"p-2 bg-white/90 hover:bg-white text-slate-700 rounded-full shadow-sm hover:shadow-md transition-all border border-slate-100",title:"Ganti Cover Lagu Ini",children:e.jsx(E,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-6 mt-2 md:mb-8 md:mt-4 group cursor-pointer",onClick:()=>c(!r),children:[e.jsxs("div",{className:`w-48 h-48 md:w-64 md:h-64 rounded-full bg-slate-900 shadow-2xl flex items-center justify-center relative overflow-hidden border-4 border-slate-800 ${r?"animate-[spin_4s_linear_infinite]":"transition-transform duration-700 ease-out"}`,children:[e.jsx("div",{className:"absolute inset-2 rounded-full border border-slate-800/50 pointer-events-none z-10"}),e.jsx("div",{className:"absolute inset-4 rounded-full border border-slate-800/50 pointer-events-none z-10"}),e.jsx("div",{className:"absolute inset-8 rounded-full border border-slate-800/50 pointer-events-none z-10"}),e.jsxs("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-full flex items-center justify-center relative shadow-inner overflow-hidden border-2 border-slate-700 bg-slate-800 z-0",children:[s.image?e.jsx("img",{src:s.image,alt:"Album Art",className:"w-full h-full object-cover opacity-90"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-tr from-blue-500 to-purple-600 opacity-80"}),e.jsx("div",{className:"absolute w-2 h-2 md:w-2.5 md:h-2.5 bg-white rounded-full shadow-sm z-20"})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-white/10 to-transparent pointer-events-none rounded-full z-20"})]}),e.jsx("div",{className:`absolute -top-8 -right-6 md:-top-12 md:-right-8 w-24 h-32 md:w-28 md:h-40 pointer-events-none transition-transform duration-1000 ease-in-out origin-[70%_15%] drop-shadow-xl z-20 ${r?"rotate-[0deg]":"-rotate-[40deg]"}`,children:e.jsxs("svg",{viewBox:"0 0 100 150",className:"w-full h-full",children:[e.jsx("circle",{cx:"70",cy:"20",r:"8",fill:"#94a3b8",stroke:"#64748b",strokeWidth:"2"}),e.jsx("path",{d:"M70 20 L60 90 L45 100",fill:"none",stroke:"#64748b",strokeWidth:"5",strokeLinecap:"round"}),e.jsx("rect",{x:"38",y:"95",width:"16",height:"20",fill:"#334155",rx:"2",transform:"rotate(20 46 105)"})]})}),!r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-30",children:e.jsx("div",{className:"bg-black/40 backdrop-blur-sm rounded-full p-3 md:p-4",children:e.jsx(Q,{className:"w-6 h-6 md:w-8 md:h-8 text-white ml-1"})})})]}),e.jsxs("div",{className:"w-full text-center",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-black text-slate-900 mb-1 leading-tight line-clamp-1 drop-shadow-sm",children:s.title}),e.jsx("p",{className:"text-xs md:text-sm text-slate-600 font-bold uppercase tracking-widest mb-4 md:mb-6 line-clamp-1",children:s.artist}),e.jsx("div",{className:"w-full rounded-2xl overflow-hidden shadow-sm border border-slate-100 bg-white/60 backdrop-blur-md relative z-20",children:e.jsx("iframe",{ref:H,src:`https://open.spotify.com/embed/track/${s.spotifyId}?utm_source=generator&theme=0&autoplay=1`,width:"100%",height:"80",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Player",className:"border-0 block",style:{overflow:"hidden"}})}),e.jsx("button",{onClick:()=>c(!r),className:"mt-4 text-[10px] font-bold text-slate-500 bg-white/70 backdrop-blur px-3 py-1.5 rounded-full hover:bg-white transition-colors shadow-sm",children:r?"Matikan Animasi Manual":"Nyalakan Animasi Manual"})]})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 md:mb-6",children:[e.jsxs("h3",{className:"text-base md:text-lg font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4 md:w-5 md:h-5 text-slate-400"})," Daftar Putar"]}),m&&e.jsx("button",{onClick:()=>S(!g),className:"text-[10px] md:text-xs font-bold bg-slate-900 text-white px-3 py-1.5 md:px-4 md:py-2 rounded-lg hover:bg-slate-800 transition-all shadow-md active:scale-95",children:g?"Tutup":"+ Add Song"})]}),g&&e.jsxs("div",{className:"bg-slate-50 p-4 md:p-6 rounded-2xl border border-slate-200 mb-6 md:mb-8 animate-fade-in-up",children:[e.jsx("h4",{className:"text-sm font-bold text-slate-800 mb-4",children:"Tambah Lagu Baru"}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{onClick:()=>{var t;return(t=_.current)==null?void 0:t.click()},className:"w-16 h-16 rounded-xl bg-white border border-slate-200 flex items-center justify-center cursor-pointer hover:border-slate-400 overflow-hidden shrink-0",children:y?e.jsx("img",{src:y,className:"w-full h-full object-cover",alt:"Preview"}):e.jsx(E,{className:"w-5 h-5 text-slate-400"})}),e.jsx("input",{type:"file",ref:_,onChange:q,className:"hidden",accept:"image/*"}),e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Link Spotify...",value:w,onChange:t=>M(t.target.value),className:"w-full px-4 py-2 md:py-3 rounded-xl bg-white border border-slate-200 text-sm focus:border-slate-900 outline-none"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 md:gap-4",children:[e.jsx("input",{type:"text",placeholder:"Judul Lagu",value:v,onChange:t=>L(t.target.value),className:"w-full px-4 py-2 md:py-3 rounded-xl bg-white border border-slate-200 text-sm focus:border-slate-900 outline-none"}),e.jsx("input",{type:"text",placeholder:"Nama Artis",value:j,onChange:t=>z(t.target.value),className:"w-full px-4 py-2 md:py-3 rounded-xl bg-white border border-slate-200 text-sm focus:border-slate-900 outline-none"})]}),e.jsx("button",{onClick:B,disabled:T,className:"w-full bg-blue-600 text-white font-bold py-2.5 md:py-3 rounded-xl hover:bg-blue-700 transition-all disabled:opacity-50 text-sm",children:T?"Menyimpan...":"Simpan ke Playlist"})]})]}),e.jsxs("div",{className:"space-y-2 md:space-y-3",children:[d.map((t,a)=>e.jsxs("div",{onClick:()=>Y(t),className:`group flex items-center gap-3 md:gap-4 p-3 pr-4 rounded-xl cursor-pointer border transition-all duration-300 ${(s==null?void 0:s.id)===t.id?"bg-slate-900 border-slate-900 shadow-lg scale-[1.01] md:scale-[1.02]":"bg-white border-slate-100 hover:border-slate-300 hover:shadow-md"}`,children:[e.jsx("div",{className:`w-10 h-10 flex items-center justify-center text-xs md:text-sm font-bold rounded-lg shrink-0 overflow-hidden ${(s==null?void 0:s.id)===t.id?"text-white":"text-slate-400 bg-slate-50 group-hover:bg-slate-100 group-hover:text-slate-600"}`,children:(s==null?void 0:s.id)===t.id&&r?e.jsxs("div",{className:"flex gap-0.5 items-end h-3",children:[e.jsx("div",{className:"w-0.5 bg-white animate-[bounce_1s_infinite] h-2"}),e.jsx("div",{className:"w-0.5 bg-white animate-[bounce_1.2s_infinite] h-3"}),e.jsx("div",{className:"w-0.5 bg-white animate-[bounce_0.8s_infinite] h-1.5"})]}):t.image?e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-full object-cover"}):a+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:`font-bold text-xs md:text-sm truncate ${(s==null?void 0:s.id)===t.id?"text-white":"text-slate-800"}`,children:t.title}),e.jsx("p",{className:`text-[10px] md:text-xs truncate ${(s==null?void 0:s.id)===t.id?"text-slate-400":"text-slate-500"}`,children:t.artist})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx("div",{className:`p-1.5 md:p-2 rounded-full transition-colors ${(s==null?void 0:s.id)===t.id?"bg-white/10 text-white":"bg-slate-100 text-slate-400 group-hover:text-green-600 group-hover:bg-green-50"}`,children:e.jsx(X,{className:"w-4 h-4"})}),m&&e.jsxs("div",{className:"flex items-center gap-1 bg-slate-50 rounded-lg p-1 border border-slate-100",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("button",{onClick:()=>D(a,"up"),disabled:a===0,className:"p-0.5 text-slate-300 hover:text-blue-600 hover:bg-blue-50 rounded disabled:opacity-20 disabled:hover:bg-transparent transition-colors",children:e.jsx(Z,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>D(a,"down"),disabled:a===d.length-1,className:"p-0.5 text-slate-300 hover:text-blue-600 hover:bg-blue-50 rounded disabled:opacity-20 disabled:hover:bg-transparent transition-colors",children:e.jsx(ee,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),e.jsx("button",{onClick:l=>J(t.id,l),className:"p-1.5 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-full transition-all",title:"Hapus",children:e.jsx(te,{className:"w-3.5 h-3.5"})})]})]})]},t.id||a)),d.length===0&&!f&&e.jsx("div",{className:"text-center py-12 text-slate-400 text-sm",children:"Playlist kosong. Tambahkan lagu baru."})]})]})]})})]})};export{me as default};
